<!DOCTYPE html>
<html>
    <head>
        <title>Zeppelin React</title>
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.12.2/react.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.12.2/JSXTransformer.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script src="bower_components/bignumber.js/bignumber.min.js"></script>
        <script src="bower_components/ethereum.js/dist/ethereum.min.js"></script>
    </head>
    <body>
        <div id="content"></div>
        <script type="text/jsx">
            var web3 = require('web3');
            web3.setProvider(new web3.providers.HttpSyncProvider());

            var InfoBox = React.createClass({
                getInitialState: function() {
                    return {
                        pending: [
                            {"key": "Block number", "value": ""},
                            {"key": "Timestamp", "value": ""},
                            {"key": "Hash", "value": ""}
                        ]
                    }
                },
                componentDidMount: function() {
                    var that = this;
                    web3.eth.watch('pending').changed(function(){
                        var blockNumber = web3.eth.number;
                        that.setState({
                          pending: [
                            {"key": "Block number", "value": blockNumber},
                            {"key": "Timestamp", "value": Date(web3.eth.block(blockNumber).timestamp).toString()},
                            {"key": "Hash", "value": web3.eth.block(blockNumber).hash},
                          ]
                        });
                    })
                },
                render: function() {
                    var pendingNodes = this.state.pending.map(function (item) {
                      return (
                        <EthInfo desc={item.key}>
                          {item.value}
                        </EthInfo>
                      );
                    });
                    return (
                      <div className="container">
                        <h1>
                          Hello blockchain!
                        </h1>
                        Look at me, I'm using react!
                        {pendingNodes}
                      </div>
                    );
                }
            });
            var EthInfo = React.createClass({
                render: function() {
                    return (
                      <div className="item">
                          <h5>
                            {this.props.desc + ": "}
                            <strong>
                                {this.props.children}
                            </strong>
                          </h5>
                      </div>
                    );
                }
            })
            React.render(
              <InfoBox />,
              document.getElementById('content')
            );
        </script>
    </body>
</html>
